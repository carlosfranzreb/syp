{% extends 'main_layout.html' %} {% block content %}

<h1>Recetas</h1>
<a href="{{ url_for('recipes.create_recipe') }}" class="add_btn" style="margin-bottom: 1em">Nueva receta</a>
<table>
  <tr>
    <th>Nombre
      <a class="icon fas fa-filter action_icon" onclick="toggle_filters(this)"></a>
      <div class="filters" style="display: none">
        <a class="icon fas fa-sort-alpha-down action_icon" onclick="sort_descending(this)" title="Ordenar A-Z"></a>
        <a class="icon fas fa-sort-alpha-desc action_icon" onclick="sort_ascending(this)" title="Ordenar Z-A"></a>
        <a class="icon fas fa-search action_icon" onclick="open_search(this)" title="Buscar"></a>
      </div>
    </th>
    <th>Último cambio
      <a class="icon fas fa-filter action_icon" onclick="toggle_filters(this)"></a>
      <div class="filters" style="display: none">
        <a class="icon fas fa-sort-alpha-down action_icon" onclick="sort_descending(this)" title="Ordenar A-Z"></a>
        <a class="icon fas fa-sort-alpha-desc action_icon" onclick="sort_ascending(this)" title="Ordenar Z-A"></a>
        <a class="icon fas fa-search action_icon" onclick="open_search(this)" title="Buscar"></a>
      </div>
    </th>
    <th>Estado
      <a class="icon fas fa-filter action_icon" onclick="toggle_filters(this)"></a>
      <div class="filters" style="display: none">
        <a 
          class="icon fas fa-sort-alpha-down action_icon" 
          href="{{ url_for('recipes.sort_by_state', desc=False) }}" 
          title="Ordenar A-Z">
        </a>
        <a 
          class="icon fas fa-sort-alpha-desc action_icon" 
          href="{{ url_for('recipes.sort_by_state', desc=True) }}" 
          title="Ordenar Z-A">
        </a>
        <a 
          class="icon fas fa-search action_icon" 
          href="" 
          title="Buscar"></a>
      </div>
    </th>
    <th>Acciones</th>
  </tr>
  {% for recipe in recipes.items %}
  <tr>
    <td>{{ recipe.name }}</td>
    {% if recipe.changed_at %}
      <td>{{ recipe.changed_at.strftime("%d-%m-%Y") }}</td>
    {% else %}
      <td>{{ recipe.created_at.strftime("%d-%m-%Y") }}</td>
    {% endif %}
    <td>
      <span class="label label-{{recipe.state.label}}">{{ recipe.state.state|upper }}</span>
    </td>
    <td>
      <a
        href="{{ url_for('recipes.get_recipe', recipe_url=recipe.url) }}"
        class="icon fas fa-eye action_icon"
        title="Ver receta."
        ><span class="label">Ver receta.</span></a
      >
      <a
        href="{{ url_for('recipes.edit_recipe', recipe_url=recipe.url) }}"
        class="icon fas fa-pencil action_icon"
        title="Editar receta."
        ><span class="label">Editar receta.</span></a
      >
      <a
        href="{{ url_for('recipes.delete_recipe', recipe_url=recipe.url) }}"
        onclick="return confirm('¿Seguro que quieres borrar la receta?')"
        class="icon fas fa-trash action_icon"
        title="Borrar receta."
      ><span class="label">Borrar receta.</span></a
    >
    </td>
  </tr>
  {% endfor %}
</table>

<center>
  {% for page_num in recipes.iter_pages(left_edge=1, right_edge=1,
  left_current=1, right_current=2) %} {% if page_num %} {% if recipes.page ==
  page_num %}
  <a
    class="btn btn-danger mb-4"
    href="{{ url_for('recipes.get_overview', page=page_num) }}"
    >{{ page_num }}</a
  >
  {% else %}
  <a
    class="btn btn-danger mb-4"
    href="{{ url_for('recipes.get_overview', page=page_num) }}"
    >{{ page_num }}</a
  >
  {% endif %} {% else %} ... {% endif %} {% endfor %}
</center>

{% endblock content %}
